<?xml version="1.0" encoding="utf-8"?>

<Package
  xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
  xmlns:com="http://schemas.microsoft.com/appx/manifest/com/windows10"
  xmlns:com2="http://schemas.microsoft.com/appx/manifest/com/windows10/2"
  xmlns:com3="http://schemas.microsoft.com/appx/manifest/com/windows10/3"
  xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10"
  xmlns:uap5="http://schemas.microsoft.com/appx/manifest/uap/windows10/5"
  xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"
  IgnorableNamespaces="uap rescap">

  <Identity
    Name="80472c8f-76e2-4c6b-bfb6-2aca3970b68d"
    Publisher="CN=sengl"
    Version="1.0.0.0" />

  <Properties>
    <DisplayName>Shmuelie.WinRTServer.Sample.Package</DisplayName>
    <PublisherDisplayName>sengl</PublisherDisplayName>
    <Logo>Images\StoreLogo.png</Logo>
  </Properties>

  <Dependencies>
    <TargetDeviceFamily Name="Windows.Desktop" MinVersion="10.0.18362.0" MaxVersionTested="10.0.22000.0" />
  </Dependencies>

  <Resources>
    <Resource Language="x-generate"/>
  </Resources>

  <Applications>
    <Application Id="App"
      Executable="$targetnametoken$.exe"
      EntryPoint="$targetentrypoint$">
      <uap:VisualElements
        DisplayName="Shmuelie.WinRTServer.Sample.Package"
        Description="Shmuelie.WinRTServer.Sample.Package"
        BackgroundColor="transparent"
        Square150x150Logo="Images\Square150x150Logo.png"
        Square44x44Logo="Images\Square44x44Logo.png">
        <uap:DefaultTile Wide310x150Logo="Images\Wide310x150Logo.png" />
        <uap:SplashScreen Image="Images\SplashScreen.png" />
      </uap:VisualElements>
    </Application>
    <Application Id="Shmuelie.WinRTServer.Sample.WpfNetFxClient"
      Executable="Shmuelie.WinRTServer.Sample.WpfNetFxClient\Shmuelie.WinRTServer.Sample.WpfNetFxClient.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="WPF .NET Framework Client"
        Description="WPF .NET Framework Client"
        BackgroundColor="transparent"
        Square150x150Logo="Images\Square150x150Logo.png"
        Square44x44Logo="Images\Square44x44Logo.png">
      </uap:VisualElements>
    </Application>
    <Application Id="Shmuelie.WinRTServer.Sample.WpfNet6Client"
      Executable="Shmuelie.WinRTServer.Sample.WpfNet6Client\Shmuelie.WinRTServer.Sample.WpfNet6Client.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="WPF .NET 6 Client"
        Description="WPF .NET 6 Client"
        BackgroundColor="transparent"
        Square150x150Logo="Images\Square150x150Logo.png"
        Square44x44Logo="Images\Square44x44Logo.png">
      </uap:VisualElements>
    </Application>
    <Application Id="Shmuelie.WinRTServer.Sample.CppConsoleClient"
      Executable="Shmuelie.WinRTServer.Sample.CppConsoleClient\Shmuelie.WinRTServer.Sample.CppConsoleClient.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="C++/WinRT Console Client"
        Description="C++/WinRT Console Client"
        BackgroundColor="transparent"
        Square150x150Logo="Images\Square150x150Logo.png"
        Square44x44Logo="Images\Square44x44Logo.png">
      </uap:VisualElements>
    </Application>
    <Application Id="Shmuelie.WinRTServer.Sample.Server"
      Executable="Shmuelie.WinRTServer.Sample.Server\Shmuelie.WinRTServer.Sample.Server.exe"
      EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements
        DisplayName="Local Server"
        Description="Local Server"
        BackgroundColor="transparent"
        Square150x150Logo="Images\Square150x150Logo.png"
        Square44x44Logo="Images\Square44x44Logo.png" AppListEntry="none">
      </uap:VisualElements>
      <Extensions>
        <!-- Only needed for COM activation -->
        <com2:Extension Category="windows.comServer">
          <com2:ComServer>
            <com3:ExeServer Executable="Shmuelie.WinRTServer.Sample.Server\Shmuelie.WinRTServer.Sample.Server.exe"
                            DisplayName="Local Server"
                            LaunchAndActivationPermission="O:SYG:SYD:(A;;11;;;WD)(A;;11;;;RC)(A;;11;;;AC)(A;;11;;;AN)S:P(ML;;NX;;;S-1-16-0)"
                            Arguments="-COM">
              <com:Class Id="4F59AF92-A98D-4A20-8C8D-1C076647A6AE" DisplayName="RemoteThing Class" />
              <com:Class Id="4F59AF92-A98D-4A20-8C8D-1C076647A6AF" DisplayName="Times Class" />
              <com:Class Id="4F59AF92-A98D-4A20-8C8D-1C076647A6B0" DisplayName="Input Class" />
            </com3:ExeServer>
          </com2:ComServer>
        </com2:Extension>
      </Extensions>
    </Application>
  </Applications>
  <Capabilities>
    <Capability Name="internetClient" />
    <rescap:Capability Name="runFullTrust" />
    <rescap:Capability Name="unvirtualizedResources" />
  </Capabilities>
  <Extensions>
    <!-- Only needed for WinRT activation -->
    <Extension Category="windows.activatableClass.outOfProcessServer">
      <OutOfProcessServer ServerName="Shmuelie.WinRTServer.WinRtServer" uap5:IdentityType="activateAsPackage" uap5:RunFullTrust="true">
        <Path>Shmuelie.WinRTServer.Sample.Server\Shmuelie.WinRTServer.Sample.Server.exe</Path>
        <Arguments>-WINRT</Arguments>
        <Instancing>singleInstance</Instancing>
        <ActivatableClass ActivatableClassId="Shmuelie.WinRTServer.Sample.RemoteThing" />
        <ActivatableClass ActivatableClassId="Shmuelie.WinRTServer.Sample.Times" />
        <ActivatableClass ActivatableClassId="Shmuelie.WinRTServer.Sample.Input" />
      </OutOfProcessServer>
    </Extension>
  </Extensions>
</Package>
